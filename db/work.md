# 目前最新 todo

* 关于下单的问题，目前解决方案为json，将选择的设置为list，然后一个商品用一个店铺批次id作为代表，如果有n个商品a，则有n个商品a的店铺批次id
* 除此之外，还有一个其他字段暂时确认为一个off的string字段，
* 在提交之后，先存入订单详情中，生成订单概览id，即一张订单表，不包括详情，只记录数量这些的

目前来看的话，视乎设计表的时候太分散了，所有频繁的左连接并且涉及了新建多个vo、dto来处理

# 总TODO：

* 线下销售、订单管理、订单详情(独立页面，点击详情或者下单才能生成)、付款(线下、线上)
* 仓库的查看详情中，对于售完、过期（2）、禁止部分按钮为全部进行校验
* 创建一个店铺管理表，对应着店铺跟店长的关系
*


* 仓库查看店铺请求页面
    * 方案一：看店铺名称、请求总量
    * 方案二：直接上，增加店铺选择器
* 店铺快速搜索加订单页面（线下销售）
* 订单查询页面
*
* 线下销售设计
    * 操作页面，一个搜索框，一个结果框，一个订单框，一个重置按钮，一个结算按钮，一个优惠券输入框，结算之后跳到订单页面
    * 订单页面，总金额，支付方式
*

# BUG——SUPER级

1.

在仓库一键更新的时候会将在当前店铺、当前药品、新建状态下的请求通过，而在仓库获取到请求到点击的时间跨度可能很长，那么就可能有新的请求发送了过来，那么此时可能就会超出了，所有需要在查询的时候把主键id也给带出来，但是主键id怎么带出来还是问题，如果通过后期Java代码插入，那么就需要再次验证一下

2.

# BUG——A级

1. 仓库批次管理中是后期加入的乐观锁version，要考虑重构一下

2. 在前端的仓库管理中，对于提交之后没有赋空值，只是在部分操作前赋空值了

3. 店铺service中fastApproval中对于店铺请求list没有顺序执行，即可能后续的拿到了老批次的，不过问题不大

# BUG——B级

1. 权限列表的编辑有问题
2. 角色列表的编辑有问题
3. 部分老的copy代码请求不规范
4. 使用两个固定的值来代表店长跟员工，然后设置多个if来获取职员list
5. 用户列表的新增少了部分字段——真实姓名、昵称
6. 设计查询员工的get方法——目前的困难在于无法从配置文件中拿到数组
7.

# 优化

1. 设计一张配方表，用于管理多个药品，例如对付什么用什么，同品类表
2. 设置一个仓库过期页面，点击进去就是一个标签页显示几个月过期，点击就是批次对应的详情

* 权限管理，管理所有权限
* 角色管理，对角色进行赋权，增删改查
* 人员管理，管理管理员（11）、店内管理人员（21）、店内普通高级人员（22）、店内普通初级人员（23）、客户（31）、供应商人员（41）——==可以用标签来进行区分==
* 有一个总药品信息表，由店内人员以及供应商提供，店内人员可以增删改查，而供应商只能增加修改自己的；——==供应商的新增的话要做角色区分==
* 药品信息有了之后，就开始进货——==根据药品查询支持的供应商，直接发起请求，仓库审核，同意之后正常进货==
*

进货之后，就是入库，进货请求发起时就已经预入库（入库状态设置为0，是在供应商同意之后添加的，批次状态/0-创建/1-进货/2-正常/3-售完/4-过期（未处理）/过期（已处理）/5-禁止-后期增加/），每次都有一个新的批号————预入库时，设置状态为0，可以设置为5不同意，审核之后是设置为1，到货之后才能是2，售完为3，批次过期为4，只能是aop每次入库、出库来处理，不过应该没问题的，注解而已——==设置页来区分不同的==

*
* 仓库有药品之后，店内要提取药品，==发出提取申请==，仓库批次数量不变，只是增加了一张提取申请表，每次提取申请的时候，仓库可以==审核（审核不通过有一个回复）==；（拓展——送货情况）
* 店内药品在仓库审核通过之后，也是预先入库（是不能销售的），确认之后才能销售；
* 销售
    * 零售：用一个机器对应的账号进行的销售，同在线销售，但是零售的话
    * 在线销售：用户注册之后购买商品
* 在线销售的补充
    * 优惠券：店内管理人员创建模板，使用模板，发券（不能抢）
    * 团购：在线对商品发起团购，邀请他人加入团购，时间设置在一天
    * 付款：暂时以账号余额为主，订单界面选择使用优惠券
    * 送货：订单生成付款之后，才送货（有固定时间段送货==bitmap了解一下==，马上送货，上门自取）
* 销售之后会有缺货问题，这边剩余几件就可以提交提货申请，类似于前面的提货申请





